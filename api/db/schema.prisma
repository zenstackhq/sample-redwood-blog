//////////////////////////////////////////////////////////////////////////////////////////////
// DO NOT MODIFY THIS FILE                                                                  //
// This file is automatically generated by ZenStack CLI and should not be manually updated. //
//////////////////////////////////////////////////////////////////////////////////////////////

datasource db {
    provider="sqlite"
    url=env("DATABASE_URL")
}

generator client {
    provider = "prisma-client-js"
    binaryTargets = "native"
    previewFeatures = ["interactiveTransactions"]
}

/// @@allow('all', auth().roles == 'admin' && auth() == user)
/// @@allow('read', published)
model Post {
    id Int @id() @default(autoincrement())
    title String
    body String
    comments Comment[]
    user User @relation(fields: [userId], references: [id])
    userId Int
    createdAt DateTime @default(now())
    published Boolean @default(true)

    zenstack_guard Boolean @default(true)
    zenstack_transaction String?

    @@index([zenstack_transaction])
}

model Contact {
    id Int @id() @default(autoincrement())
    name String
    email String
    message String
    createdAt DateTime @default(now())
}

model User {
    id Int @id() @default(autoincrement())
    name String?
    email String @unique()
    hashedPassword String
    salt String
    resetToken String?
    resetTokenExpiresAt DateTime?
    roles String @default("moderator")
    posts Post[]

    zenstack_guard Boolean @default(true)
    zenstack_transaction String?

    @@index([zenstack_transaction])
}

/// @@allow('all', auth().roles == 'moderator')
/// @@allow('create,read', post.published)
model Comment {
    id Int @id() @default(autoincrement())
    name String
    body String
    post Post @relation(fields: [postId], references: [id])
    postId Int
    createdAt DateTime @default(now())

    zenstack_guard Boolean @default(true)
    zenstack_transaction String?

    @@index([zenstack_transaction])
}